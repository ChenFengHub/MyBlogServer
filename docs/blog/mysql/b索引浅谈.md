# 索引浅谈

## 聚集索引和辅助索引

数据库中的 B+Tree 索引可以分为聚集索引（clustered index）和辅助索引（secondary index）。

1. 聚集索引：上面的 B+Tree 示例图在数据库中的实现即为聚集索引，聚集索引的 B+Tree 中的叶子节点存放的是整张表的行记录数据。
2. 辅助索引：辅助索引与聚集索引的区别在于辅助索引的叶子节点并不包含行记录的全部数据，而是存储相应行数据的聚集索引键，即主键（primary-key）。当通过辅助索引来查询数据时，InnoDB 存储引擎会先遍历辅助索引找到主键，然后再通过主键在聚集索引中找到完整的行记录数据。

## 联合索引

1. 定义：B+Tree 是按照第一个关键字进行索引，然后在叶子节点上按照第一个关键字、第二个关键字、第三个关键字 。。。 第 n 个关键字进行排序，以及指针对应的 data（指针指向 data）。

2. 实例解析图如下：年龄、姓氏、名三个字段作为联合索引。

3. 联合索引不生效：select \* from STUDENT where 名字='安';
   因为：联合索引中是先根据年龄进行排序的。如果年龄没有先确定，直接对姓氏和名字进行查询的话，就相当于乱序查询一样，因此索引无法生效。因此查询是全表查询。

4. 联合索引生效 1：select \_ from STUDENT where 年龄=1 and 姓氏='李';
   因为：先根据 age=1 查找到叶子节点，即第一个叶子节点的前 6 条记录。在 age=1 的前提下，姓氏=’李’的是前 3 条。因此最终查询出来的是这三条，从而能获取到对应记录的地址（即查找到对应记录）。

5. 联合索引生效 2： select \_ from STUDENT where 年龄=1 and 姓氏='黄' and 名字='安';
   那么索引也是生效的，如上。

6. 联合索引部分生效：select \* from STUDENT where 年龄=1 and 名字='安';
   因为：索引 age 年龄部分能生效，名字部分不能生效。也就是说索引部分生效

---

---

[前端友情链接](https://itxiaohao.github.io)
